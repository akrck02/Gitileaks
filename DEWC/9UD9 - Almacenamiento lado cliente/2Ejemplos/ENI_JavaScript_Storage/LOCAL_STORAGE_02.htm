<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<!--
NOMBRE DEL SCRIPT: LOCAL_STORAGE_02.htm
REALIZACION INFORMÁTICA: Christian VIGOUROUX
FECHA DE CREACIÒN: 01/01/2014
FECHA DE ÚLTIMA MODIFICACIÓN: 01/01/2014
OBJETIVO: Almacenamiento usando localStorage y JSON
-->

<!-- Inicio script HTML -->
<html>

	<!-- Inicio encabezado script HTML -->
	<head>

		<!-- Etiqueta meta -->
		<meta http-equiv="Content-Type"
		content="text/html; charset=utf-8" />

		<!-- Título del script HTML -->
		<title>LOCAL_STORAGE_02</title>

		<!-- Inicio script JavaScript -->
		<script type='text/javascript'>
		
			/* Función escribirLocalStorage */
			function escribirLocalStorage() {
				/* Prueba posibilidades de usar localStorage y JSON */
				if ( typeof localStorage != "undefined" && JSON) {
					/* Definición de un objeto Javascript datosContactoPersona */
					var datosContactoPersona = {
						nombre: document.getElementById("nombre").value,
						apellidos: document.getElementById("apellidos").value,
						mail: document.getElementById("mail").value
					};
					/* Serialización en un objeto JSON de nombre identidad */
					localStorage.setItem("identidad", JSON.stringify(datosContactoPersona));
					alert("Registrar en localStorage terminado");
				} else {
					/* Mensaje de error (sin posibilidades de almacenamiento localStorage) */
					alert("localStorage no soportado");
				}
			};

			/* Función eliminarLocalStorage */
			function eliminarLocalStorage() {
				/* Prueba posibilidades de usar localStorage y JSON */
				if ( typeof localStorage != "undefined" && JSON) {
					/* Eliminación de la entrada identidad en el localStorage */
					/* NB: sessionStorage.clear(); eliminará también las entradas del localStorage */
					sessionStorage.removeItem("identidad");
					/* Actualización de los campos para mostrar (<input type="texte" ... />) */
					document.getElementById("nombre").value = "";
					document.getElementById("apellidos").value = "";
					document.getElementById("mail").value = "";
					/* Mostrar de contra´le */
					alert("Eliminación de la entrada identidad en el localStorage terminada");
				} else {
					/* Mensaje de error (sin posibilidades de almacenamiento localStorage) */
					alert("localStorage no soportado");
				}
			};

		</script>

	</head>

	<!-- Inicio section body del script HTML -->
	<body>

		<!-- Título del procesamiento -->
		<h1>Editions ENI - JavaScript - LOCAL_STORAGE_02</h1>

		<!-- Inicio script JavaScript -->
		<script type='text/javascript'>
		
			/* Mostrar del nombre del script */
			alert("LOCAL_STORAGE_02");

		</script>

		<!-- Tabla de entrada y para mostrar los campos nombre, apellido y mail -->
		<table>
			<tr>
				<td>Nombre</td>
				<td>				<input
					type="text"
					id="nombre"
					value=""
					size="40"
				/>
				</td>
			</tr>
			<tr>
				<td>Apellidos</td>
				<td>
				<input
					type="text"
					id="apellidos"
					value=""
					size="40"
				/>
				</td>
			</tr>
			<tr>
				<td>Mail</td>
				<td>
				<input
					type="text"
					id="mail"
					value=""
					size="40"
				/>
				</td>
			</tr>
		</table>

		<!-- Formulario con botones de escritura, lectura y borrado -->
		<br />
		<form>
			<input
				type="button"
				id="botonEscritura"
				value="Escritura en localStorage"
				onclick="escribirLocalStorage();"
			/>
			<br />
			<input
				type="button"
				id="botonLectura"
				value="Lectura desde localStorage"
			/>
			<br />
			<input
				type="button"
				id="boutonEliminacion"
				value="Eliminación de la entrada en localStorage"
				onclick="eliminarLocalStorage();"
			/>
		</form>

		<!-- Inicio script JavaScript -->
		<script type='text/javascript'>
			/* Lectura desde el localStorage */
			document.getElementById('botonLectura').onclick = function() {
				/* Prueba las posibilidades de usar localStorage y JSON */
				if ( typeof localStorage != "undefined" && JSON) {
					/* Desserialización del objeto JSON leído */
					var datosContactoPersona = JSON.parse(localStorage.getItem("identidad"));
					/* Actualización de los campos para mostrar (<input type="texte" ... />) */
					document.getElementById("nombre").value = datosContactoPersona.nombre;
					document.getElementById("apellidos").value = datosContactoPersona.apellidos;
					document.getElementById("mail").value = datosContactoPersona.mail;
					/* Mostrar de contra´le */
					alert("Lectura desde localStorage terminada");
				} else {
					/* Mensaje de error (sin posibilidades de almacenamiento localStorage) */
					alert("localStorage no soportado");
				}
			};

		</script>

		<!-- Mostrar el código fuente -->
		<br />
		<br />
		<br />
		<center>
			<a href="JavaScript:window.location='view-source:' + window.location"> Código fuente </a>
		</center>

	</body>

</html>